
# ⛓ [GROUP BY](https://programmers.co.kr/learn/courses/30/parts/17044)

[1] 고양이와 개는 몇 마리 있을까 : [Link](https://programmers.co.kr/learn/courses/30/lessons/59040)
```sql
SELECT ANIMAL_TYPE, COUNT(ANIMAL_ID) AS "count"
FROM ANIMAL_INS
GROUP BY ANIMAL_TYPE
ORDER BY ANIMAL_TYPE ASC;
```
<br/>

[2] 동명 동물 수 찾기 : [Link](https://programmers.co.kr/learn/courses/30/lessons/59041)
```sql
SELECT NAME, COUNT(NAME) AS "COUNT"
FROM ANIMAL_INS
GROUP BY NAME
HAVING COUNT >= 2
ORDER BY NAME ASC;
```
<br/>

[3] 입양 시각 구하기(1) : [Link](https://programmers.co.kr/learn/courses/30/lessons/59412)
```sql
SELECT HOUR(DATETIME) AS "HOUR", COUNT(ANIMAL_ID) AS "COUNT"
FROM ANIMAL_OUTS
GROUP BY HOUR(DATETIME)
HAVING HOUR >= 9 AND HOUR <= 19
ORDER BY HOUR ASC;
```
```sql
SELECT HOUR(DATETIME) AS "HOUR", COUNT(ANIMAL_ID) AS "COUNT"
FROM ANIMAL_OUTS
GROUP BY HOUR(DATETIME)
HAVING HOUR BETWEEN 9 AND 19
ORDER BY HOUR ASC;
```
<br/>

[4] 입양 시각 구하기(2) : [Link](https://programmers.co.kr/learn/courses/30/lessons/59413)
```sql
SET @HOUR := -1;

SELECT (@HOUR := @HOUR + 1) AS "HOUR", (
    SELECT COUNT(ANIMAL_ID) 
    FROM ANIMAL_OUTS
    WHERE HOUR(DATETIME) = @HOUR
) AS "COUNT"
FROM ANIMAL_OUTS
WHERE @HOUR < 23;
```
```sql
SELECT TMP.HOUR AS "HOUR", COUNT(ANIMAL_OUTS.ANIMAL_ID) AS "COUNT"
FROM (
    SELECT 0 AS HOUR
    UNION SELECT 1 UNION SELECT 2 UNION SELECT 3
    UNION SELECT 4 UNION SELECT 5 UNION SELECT 6
    UNION SELECT 7 UNION SELECT 8 UNION SELECT 9
    UNION SELECT 10 UNION SELECT 11 UNION SELECT 12
    UNION SELECT 13 UNION SELECT 14 UNION SELECT 15
    UNION SELECT 16 UNION SELECT 17 UNION SELECT 18
    UNION SELECT 19 UNION SELECT 20 UNION SELECT 21
    UNION SELECT 22 UNION SELECT 23
    ) AS TMP
    LEFT JOIN ANIMAL_OUTS ON TMP.HOUR = HOUR(ANIMAL_OUTS.DATETIME)
GROUP BY HOUR
ORDER BY HOUR;
```
```sql
SELECT TMP.HOUR AS "HOUR", IFNULL(OUTS.COUNT, 0) AS "COUNT"
FROM (
    SELECT 0 AS HOUR
    UNION SELECT 1 UNION SELECT 2 UNION SELECT 3
    UNION SELECT 4 UNION SELECT 5 UNION SELECT 6
    UNION SELECT 7 UNION SELECT 8 UNION SELECT 9
    UNION SELECT 10 UNION SELECT 11 UNION SELECT 12
    UNION SELECT 13 UNION SELECT 14 UNION SELECT 15
    UNION SELECT 16 UNION SELECT 17 UNION SELECT 18
    UNION SELECT 19 UNION SELECT 20 UNION SELECT 21
    UNION SELECT 22 UNION SELECT 23
    ) AS TMP
    LEFT JOIN (
    SELECT HOUR(DATETIME) AS "HOUR", COUNT(ANIMAL_ID) AS "COUNT"
    FROM ANIMAL_OUTS
    GROUP BY HOUR
    ) AS OUTS
    ON TMP.HOUR = OUTS.HOUR
ORDER BY HOUR;
```
```sql
WITH RECURSIVE TMP AS (
    SELECT 0 AS "HOUR"
    UNION ALL
    SELECT HOUR + 1
    FROM TMP
    WHERE HOUR < 23
)

SELECT HOUR, COUNT(ANIMAL_OUTS.ANIMAL_ID) AS "COUNT"
FROM TMP
    LEFT JOIN ANIMAL_OUTS ON TMP.HOUR = HOUR(ANIMAL_OUTS.DATETIME)
GROUP BY HOUR
ORDER BY HOUR;
```